<div class="scanner-container">
  <video id="qr-video"></video>
  <div id="qr-result">Čekam kameru...</div>
</div>

<script>
  import { BrowserQRCodeReader } from "@zxing/browser"

  const codeReader = new BrowserQRCodeReader()
  const videoElement = document.getElementById("qr-video")
  const resultElement = document.getElementById("qr-result")

  async function startScanning() {
    try {
      if (!videoElement) {
        throw new Error("Video element not found")
      }
      // Pokreće skeniranje s prve dostupne kamere
      const result = await codeReader.decodeOnceFromVideoDevice(
        undefined,
        videoElement as HTMLVideoElement
      )

      if (resultElement) {
        resultElement.textContent = `Skenirano: ${result.getText()}`
        resultElement.classList.add("success")
      }
      console.log("QR Result:", result)
    } catch (err) {
      console.error(err)
      if (resultElement) {
        resultElement.textContent = "Greška ili prekinuto skeniranje."
      }
    }
  }

  startScanning()
</script>

<style>
  .scanner-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1rem;
    width: 100%;
    max-width: 600px;
    margin: 0 auto;
  }

  video {
    width: 100%;
    border-radius: 12px;
    background-color: #000;
  }

  #qr-result {
    padding: 1rem;
    background-color: #f0f0f0;
    border-radius: 8px;
    width: 100%;
    text-align: center;
    font-family: monospace;
    word-break: break-all;
  }

  #qr-result.success {
    background-color: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  }
</style>
